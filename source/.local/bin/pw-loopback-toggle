#!/usr/bin/env zsh
# ---------------------------------------------------------------------------------------------------------------------
# PIPE-WIRE LOOPBACK TOGGLE
#
# A short and sweet wrapper over the `pw-loopback` utility that toggles the loopback on or off, keeping the loopback
# process in a background job.
# ---------------------------------------------------------------------------------------------------------------------

# Get the pid of the previous loopback, if any.
LOOPBACK_PID=$(pidof pw-loopback)

if [[ -z "$LOOPBACK_PID" ]]; then
  pw-loopback &!
  MESSAGE=' Loopback Enabled.'
else
  kill "$LOOPBACK_PID"
  MESSAGE=' Loopback Disabled.'
fi

notify-send --app-name='pw-loopback-toggle' --urgency='low' --expire-time=1000 "$MESSAGE"
